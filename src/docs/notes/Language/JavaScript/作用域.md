---
title: 作用域
article: false
category:
  - JavaScript
---
## 作用域和作用域链
### 什么是作用域
作用域是一个代码段所在的区域
### 作用域的作用
隔离变量，不同作用域下同名变量不会有冲突
### 计算作用域的个数
n+1，n是定义函数的个数，1是全局作用域
### 全局作用域
#### 什么是全局作用域
在函数之外声明的变量拥有*全局作用域*。*全局*变量可以在 JavaScript 程序中的任何位置访问。
- 直接编写在Script标签中的代码都在全局作用域中
- 全局作用域在页面打开时创建，在页面关闭时销毁
- 在全局作用域中，有一个全局对象window，window代表的是一个浏览器的窗口，可以直接使用
  - 在全局作用域中，创建的变量都会作为window对象的属性保存
  - 创建的函数都会作为window对象的方法保存
- 全局作用域中的变量都是全局变量
  - 在页面的任意的部分都可以访问的到
### 函数作用域（部分作用域）
#### 什么是函数作用域
函数内声明的变量拥有*函数作用域*。*局部*变量只能在它们被声明的函数内访问。
- 调用函数时创建函数作用域，函数执行完毕后，函数作用域销毁
- 每调用一次函数就会创建一个新的函数作用域，他们之间是相互独立的
- 在函数作用域中可以使用window对象，访问到全局作用域的变量
- 在全局作用域中不能访问到函数作用域的变量
- 在函数作用域中操作一个变量时，它会先在自身作用域中寻找，如果有就直接使用，如果没有，则向上一级作用域中寻找
  - 全局作用域，函数1作用域，在函数1中套娃的函数2作用域
  - 在函数2中操作变量时，先在函数2作用域中查找，若没有，则在函数1作用域中查找，若没有，则在全局作用域中查找，若没有，则报错RefenerceError	
### 块作用域（ES6）
在块{}内声明的变量拥有块作用域。块变量只能在块中访问。
#### let
- 通过 var 关键词声明的变量没有块*作用域*。在块 *{}1. 内声明的变量可以从块之外进行访问
  ```javascript
  { 
    var x = 10; 
  }
  // 此处可以使用 x
  ```

- 通过let 关键词声明的变量拥有块作用域。在块 *{}1. 内声明的变量无法从块外访问

  ```javascript
  { 
    let x = 10;
  }
  // 此处不可以使用 x
  ```

- 使用 let 关键字可以对变量进行重新声明

  ```javascript
  var x = 10;
  // 此处 x 为 10
  { 
    let x = 6;
    // 此处 x 为 6
  }
  // 此处 x 为 10
  ```

#### const
const声明一个不变的量，拥有块作用域。const声明变量时必须赋值
### 作用域和执行上下文的区别
1. 区别一：
1. 全局作用域之外，每个函数都会创建自己的作用域，作用域在函数定义时就已经确定了。而不是在函数调用时
1. 全局执行上下文环境是在全局作用域确定之后, js代码马上执行之前创建
1. 函数执行上下文环境是在调用函数时, 函数体代码执行之前创建
2. 区别二：
1. 作用域是静态的, 只要函数定义好了就一直存在, 且不会再变化
1. 上下文环境是动态的, 调用函数时创建, 函数调用结束时上下文环境就会被释放
### 作用域和执行上下文的联系
1. 上下文环境(对象)是从属于所在的作用域
1. 全局上下文环境==>全局作用域
1. 函数上下文环境==>对应的函数使用域

### 什么是作用域链
1. 多个上下级关系的作用域形成的链, 它的方向是从下向上的(从内到外)
1. 查找变量时就是沿着作用域链来查找的
### 如何在作用域链上查找
1. 在当前作用域下的执行上下文中查找对应的属性, 如果有直接返回, 否则进入2
1. 在上一级作用域的执行上下文中查找对应的属性, 如果有直接返回, 否则进入3
1. 再次执行2的相同操作, 直到全局作用域, 如果还找不到就抛出找不到的异常

